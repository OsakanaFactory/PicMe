# PicMe - 変更履歴

すべての重要な変更をこのファイルに記載しています。

## バージョン表記方法

このプロジェクトはセマンティックバージョニング（[SemVer](http://semver.org/)）に従います。

- **メジャー版**: 大きな機能追加またはフェーズ完了（v1.0, v2.0, v3.0...）
- **マイナー版**: 新機能追加（v1.1, v1.2...）
- **パッチ版**: バグ修正（v1.0.1, v1.0.2...）

---

## [開発中 / Unreleased]

### 計画中の機能

- カスタムドメイン対応（任意）

---

## [v5.3.10] - 2026-02-17

### 追加（Added）
- バックエンド: サイトマップ用APIエンドポイント `GET /api/users/sitemap` を追加
- フロントエンド: sitemap.ts を動的生成に改善（全アクティブユーザーのポートフォリオページを自動包含）
- フロントエンド: robots.ts に `/forgot-password`, `/reset-password`, `/verify-email` をdisallow追加

### 変更（Changed）
- サイトマップからGoogle/Bingが無視する `changeFrequency`/`priority` を削除
- ISR `revalidate = 3600` で1時間ごとにサイトマップを再生成

---

## [v5.3.9] - 2026-02-17

### 修正（Fixed）
- LP の SEO用静的リンク（`<a>`タグ）による ESLint ビルドエラーを修正

---

## [v5.3.8] - 2026-02-17

### 追加（Added）
- Google Analytics 4 (gtag.js) をサイト全体に導入
  - `layout.tsx` に `NEXT_PUBLIC_GA_ID` 環境変数ベースで gtag スクリプトを追加
  - `afterInteractive` 戦略でパフォーマンスに配慮

---

## [v5.3.7] - 2026-02-17

### 変更（Changed）
- LP（ランディングページ）のSEO改善: サーバーコンポーネント化
  - `page.tsx` を Server Component + Client Component に分離
  - `metadata` エクスポートで title / description / OG tags / canonical を LP 専用に設定
  - SEO用の静的テキスト（見出し、機能説明、料金プラン等）をサーバーサイドHTMLに含める
  - Googlebot がテキストコンテンツを確実にインデックスできるよう対応

---

## [v5.3.6] - 2026-02-17

### 修正（Fixed）
- docker-compose.yml: バックエンドの `volumes: ./backend:/app` マウントを除去
  - ビルド済み jar ファイルがホストディレクトリで上書きされ `Unable to access jarfile app.jar` エラーになる問題を修正

---

## [v5.3.5] - 2026-02-17

### 変更（Changed）
- ダッシュボード全画面のデザイン簡素化（12ファイル）
  - ネオブルータリスト装飾（太枠 `border-2 border-slate-900`、`shadow-[4px_4px_0px]`）をクリーンなスタイル（`border border-slate-200`）に変更
  - 重い Framer Motion ホバーアニメーション（`whileHover` の boxShadow/scale/rotate）を CSS transition（`hover:shadow-sm`）に置換
  - 不要コンポーネント参照を除去（`FloatingShapes`、`SquigglyLine`）
  - `PageHeader` から装飾（SquigglyLine、太字 font-black）を削除し、シンプルな `font-bold` に
  - サイドバーの公開ページリンクをシンプルな枠線スタイルに変更
  - User 型に `colorAccent` を追加し、ダッシュボードのアクセントバーに反映
- 対象画面: dashboard, artworks, profile, analytics, categories, custom-css, posts, social-links, tags, themes, upgrade, layout, sidebar, page-header

---

## [v5.3.4] - 2026-02-10

### 修正（Fixed）
- バックエンド Dockerfile の COPY パスを `docker-compose.yml` の `context: ./backend` に合わせて修正
  - `COPY backend/src src` → `COPY src src` 等、`backend/` プレフィックスを除去

---

## [v5.3.3] - 2026-02-10

### 追加（Added）
- 全ページデザイン統一: LP品質「Magazine Pop」スタイルへ引き上げ
  - 共通アニメーション基盤 `motion.ts` 新規作成（fadeInUp, dashStagger等バリアント集約）
  - 統一ページヘッダー `PageHeader` コンポーネント新規作成
  - 軽量フローティング図形 `FloatingShapes` コンポーネント新規作成（auth用5図形/dashboard用3図形）
- 認証ページ 5画面: ネオブルータリストカード化 + Framer Motionアニメーション
  - login, signup, forgot-password, reset-password, verify-email
- ダッシュボード共通: モバイルヘッダー + スライドインサイドバー + ページ遷移アニメーション
  - layout.tsx: モバイル対応ハンバーガーメニュー、AnimatePresence遷移
  - sidebar.tsx: variant prop（desktop/mobile）、whileHover微シフト、自動クローズ
- ダッシュボードページ 11画面: カードリフト効果 + スタガーアニメーション + アクセントカラーバー
  - dashboard, profile, artworks, posts, themes, social-links, categories, tags, analytics, custom-css, upgrade

---

## [v5.3.2] - 2026-02-10

### 追加（Added）
- SEO対応: `robots.ts`（robots.txt動的生成）を追加
  - 公開ページのクロールを許可、`/api/`・`/dashboard/`・`/admin/`・`/settings/`をブロック
  - サイトマップURL（`https://pic-me.net/sitemap.xml`）をクローラに通知
- SEO対応: `sitemap.ts`（sitemap.xml動的生成）を追加
  - トップページ、ログイン、サインアップページを登録

---

## [v5.3.1] - 2026-02-10

### 追加（Added）
- Framer Motion によるアニメーション強化
  - ヒーロー: staggerChildren による自然なウェーブ演出、ハイライトの scaleX アニメーション
  - スクロール連動: whileInView でセクションごとのフェードイン（カスタムhook廃止）
  - カード/ボタン: spring physics ベースの whileHover エフェクト
  - テーマデモ: カラー値の animate による滑らかなテーマ切替トランジション
  - ヘッダー: スライドインアニメーション
  - モックアップ: spring ベースの回転・スケール・シャドウアニメーション
- 幾何学図形をページ全体に拡張（15個、全セクション境界に配置）
  - useScroll + useTransform + useSpring によるパララックス効果
  - ring（輪っか）、wave（波線SVG）の新図形タイプ追加

### 変更（Changed）
- CSS transition ベースのアニメーションを Framer Motion に置き換え
- テーマデモのカラー管理を Tailwind クラスから直接カラー値に変更（animate互換のため）

---

## [v5.3] - 2026-02-10

### 追加（Added）
- ランディングページ（LP）を実装 — トップページ（`/`）にサービス紹介を表示
  - エディトリアル＋ギャラリー風デザイン（大胆なタイポグラフィ、幾何学図形の浮遊アニメーション）
  - ヒーローセクション（メインコピー、CSSアートモックアップ、staggeredアニメーション）
  - 特徴セクション（3カード スタッガード配置 + 追加機能バッジ）
  - テーマデモセクション（LIGHT/DARK/WARM/COOLのインタラクティブ切替プレビュー）
  - ステップセクション（3ステップ、巨大背景番号）
  - プランセクション（FREE/STARTER/PRO/STUDIO、PRO推奨バッジ）
  - スティッキーヘッダー（スクロール時ボーダー追加、ログイン状態で表示切替）
  - フッター（利用規約・プライバシーポリシーリンク）
  - Intersection Observer によるスクロール連動フェードインアニメーション
- Tailwind に `float` キーフレームアニメーション追加

### 変更（Changed）
- トップページ（`/`）をログインリダイレクトからLP表示に変更

---

## [v5.2.2] - 2026-02-09

### 修正（Fixed）
- 公開ページでテーマ設定（テーマ色/カスタムカラー/フォント/レイアウト）が反映されない不具合を修正

### 変更（Changed）
- SquigglyLine/BentoGridItemコンポーネントに`style` prop追加

---

## [v5.2.1] - 2026-02-09

### 修正（Fixed）
- Stripe Webhook デシリアライゼーション不具合を修正（SDK/APIバージョン不一致時に`deserializeUnsafe()`フォールバック追加）
- 全Webhookハンドラにエラーログ追加（silent failure防止）

### 変更（Changed）
- `show-sql`/`format_sql`をデフォルトOFFに変更（本番ログの可読性向上）
- Hibernate/Spring/Securityログレベルを`WARN`に調整
- `com.picme`デフォルトログレベルを`DEBUG`→`INFO`に変更

---

## [v5.2] - 2026-02-08

### 追加（Added）
- GitHub Actions CI/CDパイプライン（backend-test + frontend-buildジョブ）
- ルート`.env`ファイルによるローカル開発用環境変数管理
- `railway.json` Config-as-code（Dockerfileビルダー設定）
- `backend/.dockerignore`, `frontend/.dockerignore` 追加

### 変更（Changed）
- `docker-compose.yml`からハードコードされた秘密情報を除去し、`.env`ファイル参照に変更
- `backend/Dockerfile`をマルチステージビルド化（JDKビルド→JRE実行、Debianベース）
- `application.yml`のポート変数を`SERVER_PORT`→`PORT`に変更（Railway互換）
- ログレベルを環境変数`LOG_LEVEL`で設定可能に変更
- `frontend/src/lib/api.ts`のbaseURLをSSR/ブラウザで分岐する本番対応に修正
- `next.config.js`のrewritesでAPIプロキシ設定を改善
- `frontend/src/lib/subscription.ts`のプラン価格を更新（Starter 480円、Pro 680円、Studio 1,980円）

### デプロイ（Deploy）
- Railwayバックエンド + PostgreSQL デプロイ完了（プライベートネットワーク接続）
- Vercelフロントエンド デプロイ完了
- カスタムドメイン `pic-me.net` 設定完了（Xserver Domain + Vercel）
- ユーザー登録・ログイン動作確認済み

### セキュリティ（Security）
- Cloudinary、SendGrid、Stripe のAPIキーをdocker-compose.ymlから完全除去（要キーローテーション）

### 注意（Notes）
- Stripe Webhook未設定（本番テスト後に設定予定）
- APIキーローテーション未実施（Git履歴に旧キー残存）
- CI/CDのci.ymlはGitHubトークンのworkflowスコープ追加後に再pushが必要

---

## [v5.1] - 2026-02-07

### 修正（Fixed）

#### v5.1.0 — バグ修正
- `contactFormEnabled` がプロフィール更新APIで保存されるよう修正（PROF-009, LIMIT-016）
- アクセス解析APIにPRO/STUDIOプランチェック追加（ANAL-003, LIMIT-009, LIMIT-011）
- Stripe未設定時にサブスクリプションステータスがデフォルトFREEレスポンスを返却（SUB-001）
- テーマ名バリデーション追加（LIGHT/DARK/WARM/COOLのみ許可）（THEME-004）

#### v5.1.1 — セキュリティ修正
- 未認証リクエストが401を返すようカスタムAuthenticationEntryPoint追加（AUTH-012, AUTH-013, SUB-005）
- CORSプリフライトリクエスト（OPTIONS）が403を返す問題を修正（SEC-005）

#### v5.1.2 — フロントエンド修正
- SubscriptionContextのエラーハンドリング改善：500エラー時にデフォルトFREEプランにフォールバック（E2E-004）

#### v5.1.3 — 回帰テスト追加修正
- SubscriptionControllerの`@AuthenticationPrincipal Jwt`→`UserDetails`に統一（SUB-001根本原因）

### テスト結果
- **回帰テスト**: v5.0でFAILだった12件全てPASS確認済み

---

## [v5.0] - 2026-02-07

### 追加（Added）

- **総合テスト仕様書 v5.0**（`docs/test/総合テスト仕様書_v5.0.md`）
  - 全16カテゴリ・136テストケースの定義と実行結果
  - API直接テスト（Playwright HTTP）+ E2Eブラウザテスト
  - テストユーザー環境構築（FREE/STARTER/PRO/STUDIO/ADMIN）

### テスト結果

- **合格率**: 90.4%（123 PASS / 12 FAIL / 1 SKIP）
- **完全合格カテゴリ**: SNS、POST、CAT、TAG、CSS、PUB、ADMIN（7カテゴリ 100%）

### 検出された不具合

- `contactFormEnabled` がプロフィール更新APIで保存されない（PROF-009, LIMIT-016）
- アクセス解析APIにプラン制限未実装（ANAL-003, LIMIT-009, LIMIT-011）
- Stripe未設定時にサブスクリプションステータスが500エラー（SUB-001）
- 未認証リクエストが401ではなく403を返す（AUTH-012, AUTH-013, SUB-005）
- CORS OPTIONSリクエストが403を返す（SEC-005）
- テーマ名のバリデーション未実装（THEME-004）
- 管理者フロントエンドログインでサーバーエラー（E2E-004）

---

## [v4.6] - 2026-02-07

### 修正（Fixed）

- **AuthContext planTypeハードコード修正**
  - ページリフレッシュ時にplanTypeが常にFREEになるバグを修正
  - ProfileResponseにplanTypeフィールドを追加
  - ProfileServiceImpl.mapToResponse()でSubscriptionからplanTypeを取得

### 追加（Added）

- **環境構築ガイド**
  - backend/.env.example（全環境変数テンプレート）
  - frontend/.env.example
  - docs/環境構築ガイド.md（Cloudinary, SendGrid, Stripe, AdSenseの設定手順）

### 変更（Changed）

- **基本設計書 v2.0に更新**
  - システム構成図にSendGrid, Stripeを追加
  - バックエンド/フロントエンド構成を実際のコードに合わせて全面更新
  - DBテーブル定義: profiles(custom_css, contact_form_enabled), artworks(file_size), posts(thumbnail_url, content_format, view_count)追加
  - verification_tokens, password_reset_tokensテーブル追加
  - API設計: 認証(verify, forgot/reset-password), お知らせ, アクセス解析, 公開ページ, 管理者認証API追加
  - プラン別制限にストレージ, カスタムCSS, Markdown, 問い合わせ, アクセス解析を追加

- **詳細設計書 v2.0に更新**
  - 画面一覧: メール認証(A04), パスワード忘れ(A05), パスワードリセット(A06), アクセス解析(B08), カスタムCSS(B09), テーマ設定(B10), タグ管理(B11)追加
  - 画面遷移図をv4.5の実装に合わせて更新
  - バリデーションルール: カスタムCSS, 問い合わせ, 画像アップロード追加
  - プラン別制限テーブルを全面更新

---

## [v4.5] - 2026-02-07

### 追加（Added）

- **ドラッグ&ドロップ並び替え**
  - @dnd-kit/core, @dnd-kit/sortable, @dnd-kit/utilities 導入
  - SortableArtworkList コンポーネント（グリッド内D&D並び替え）
  - SortableSocialLinkList コンポーネント（リスト内D&D並び替え）
  - artworksページ・social-linksページに「並び替えモード」切替ボタン追加
  - 並び替え結果はPUT /api/artworks/reorder, /api/social-links/reorder で保存

- **Markdownエディタ（PRO/STUDIO）**
  - @uiw/react-md-editor 導入
  - Post.contentFormat フィールド追加（PLAIN/MARKDOWN）
  - postsページにMarkdown ON/OFF切替ボタン（PRO以上で表示）
  - MarkdownEditor コンポーネント（動的インポートでSSR回避）
  - バックエンドでMARKDOWN形式のプランチェック

---

## [v4.4] - 2026-02-07

### 追加（Added）

- **問い合わせフォーム（PRO/STUDIO）**
  - POST /api/users/{username}/inquiries（問い合わせ受付 + メール通知）
  - PublicInquiryRequest DTO
  - 公開ページにコンタクトフォーム表示（contactFormEnabled時）

- **アクセス解析（PRO/STUDIO）**
  - PageViewエンティティ + PageViewRepository
  - AnalyticsService（@Asyncページビュー記録 + 集計）
  - GET /api/analytics/summary（総PV・今日・今週・今月・流入元）
  - GET /api/analytics/timeline?days=30（日別アクセス数）
  - @EnableAsync追加（非同期処理基盤）
  - フロントエンド: analyticsページ（CSSバーチャート、期間選択、流入元一覧）

- **カスタムCSS（PRO/STUDIO）**
  - Profile.customCss + contactFormEnabledフィールド追加
  - CssSanitizer（@import, url(), expression(), javascript:等をブロック）
  - PUT /api/profile/custom-css（プランベース行数制限: PRO 100行, STUDIO 500行）
  - フロントエンド: custom-cssページ（ダークテーマエディタ + ライブプレビュー）
  - 公開ページにカスタムCSS自動適用

- **サイドバー更新**
  - 「アクセス解析」リンク追加（PRO以上で表示）
  - 「カスタムCSS」リンク追加（PRO以上で表示）

- **PublicPageResponse拡張**
  - contactFormEnabled, customCssフィールド追加

---

## [v4.3] - 2026-02-07

### 追加（Added）

- **SendGridメール基盤**
  - SendGridConfig（環境変数ベース設定）
  - EmailService interface + EmailServiceImpl
  - SendGrid未設定時はコンソールにURL出力（開発用フォールバック）

- **メール認証機能**
  - VerificationTokenエンティティ（有効期限: 24時間）
  - サインアップ時に認証メール自動送信
  - GET /api/auth/verify?token=xxx（メール認証）
  - POST /api/auth/resend-verification（認証メール再送）
  - verify-emailページ（トークンベース認証）
  - EmailVerificationBanner（ダッシュボード上部の未認証通知）

- **パスワードリセット機能**
  - PasswordResetTokenエンティティ（有効期限: 1時間）
  - POST /api/auth/forgot-password（リセットリクエスト）
  - POST /api/auth/reset-password（パスワード変更実行）
  - forgot-passwordページ（メールアドレス入力）
  - reset-passwordページ（新パスワード設定）

---

## [v4.2] - 2026-02-07

### 追加（Added）

- **Cloudinary画像アップロード**
  - CloudinaryConfig（環境変数ベースの設定）
  - CloudinaryService（アップロード、削除、最適化URL、サムネイル生成）
  - POST /api/artworks/upload（作品画像アップロード、multipart/form-data）
  - POST /api/profile/avatar（アバター画像アップロード）
  - POST /api/profile/header（ヘッダー画像アップロード）
  - ストレージ制限チェック（FREE:300MB, STARTER:1GB, PRO:2GB, STUDIO:10GB）
  - Artwork.fileSizeフィールド追加（ストレージ使用量追跡）

- **管理者アカウント作成API**
  - POST /api/admin/users/create（ユーザー名/メール/パスワード指定）
  - AdminCreateUserRequest DTO

- **フロントエンド改善**
  - FileUploadコンポーネント（ドラッグ&ドロップ、プレビュー、プログレスバー）
  - 作品管理ページをファイルアップロード対応に改修
  - プロフィールページにアバター/ヘッダーのファイルアップロード追加
  - upload.ts ユーティリティ（uploadArtwork, uploadAvatar, uploadHeader）
  - alert.tsx UIコンポーネント追加

### 修正（Fixed）

- Button variant 'default' → 'primary' 型エラー修正（複数ページ）
- named import → default import 修正（api, apiClient）
- Select コンポーネント使用法修正（themes/page.tsx）

---

## [v4.1] - 2026-02-03

### 追加（Added）

- **管理者認証機能**
  - AdminUserエンティティ（管理者ユーザー）
  - AdminRole列挙型（ADMIN, SUPER_ADMIN）
  - AdminUserDetailsService（Spring Security用）
  - 管理者専用JWT生成（admin claimを含む）
  - JwtAuthenticationFilterの管理者トークン対応
  - POST /api/admin/auth/login - 管理者ログイン
  - POST /api/admin/auth/refresh - トークンリフレッシュ

- **管理者ダッシュボードAPI**
  - GET /api/admin/dashboard - ダッシュボード統計
    - 総ユーザー数、有料ユーザー数
    - 月間収益（サブスクリプション）
    - プラン別ユーザー分布
    - 最近の登録ユーザー
    - 未対応問い合わせ数

- **ユーザー管理API**
  - GET /api/admin/users - ユーザー一覧（検索・フィルター対応）
  - GET /api/admin/users/:id - ユーザー詳細
  - POST /api/admin/users/:id/suspend - アカウント停止
  - POST /api/admin/users/:id/activate - アカウント有効化

- **サブスクリプション管理API**
  - GET /api/admin/subscriptions - サブスクリプション一覧
  - GET /api/admin/subscriptions/stats - サブスクリプション統計
    - MRR（月間経常収益）
    - プラン別統計
    - 解約率

- **問い合わせ管理機能**
  - Inquiryエンティティ（問い合わせ）
  - InquiryStatus列挙型（PENDING, IN_PROGRESS, RESOLVED, CLOSED）
  - GET /api/admin/inquiries - 問い合わせ一覧
  - GET /api/admin/inquiries/:id - 問い合わせ詳細
  - PUT /api/admin/inquiries/:id/status - ステータス更新（管理者メモ対応）

- **システム監視API**
  - GET /api/admin/system/metrics - システムメトリクス
    - CPU使用率
    - メモリ使用率
    - ディスク使用率
    - データベース接続状況
    - エラー統計

- **管理者フロントエンド**
  - 管理者ログイン画面（/admin/login）
  - 管理者ダッシュボード（/admin/dashboard）
  - ユーザー管理画面（/admin/users）
  - サブスクリプション管理画面（/admin/subscriptions）
  - 問い合わせ管理画面（/admin/inquiries）
  - システム監視画面（/admin/system）
  - AdminAuthContext（管理者認証状態管理）
  - AdminSidebarコンポーネント

### 変更（Changed）

- SecurityConfig: /api/admin/auth/** を公開エンドポイントに追加
- JwtTokenProvider: 管理者トークン生成・検証メソッド追加
- JwtAuthenticationFilter: 管理者トークンとユーザートークンの分離処理
- UserRepository: findAllByOrderByCreatedAtDesc メソッド追加

### 注意（Notes）

- 管理者アカウントは直接データベースに作成する必要がある（v4.2で作成API実装予定）
- 管理者トークンには "admin" claim が含まれ、通常ユーザートークンと区別される
- @PreAuthorize("hasRole('ADMIN')") により管理者エンドポイントを保護

---

## [v4.0.1] - 2026-02-03

### 修正（Fixed）

- **バックエンド起動失敗の修正**
  - `ApiException.unauthorized(String message)` メソッドオーバーロード追加
    - `AdminAuthServiceImpl` から呼び出されていた未定義メソッドを追加
  - `SubscriptionServiceImpl` のインポート文修正
    - `com.stripe.model.Subscription` と `com.picme.backend.model.Subscription` の衝突を解決
    - ワイルドカードインポートを明示的インポートに変更
  - `SecurityConfig` の `@Qualifier` 追加
    - 複数の `UserDetailsService` Bean（`adminUserDetailsService`, `customUserDetailsService`）の衝突を解決
    - `customUserDetailsService` を明示的に指定

---

## [v4.0] - 2026-02-03

### 追加（Added）

- **管理者機能フェーズ開始**
  - v4.xフェーズの計画策定
  - 管理者機能の設計・基盤準備

### 注意（Notes）

- 実際の管理者機能実装はv4.1で完了
- v4.0は計画・設計フェーズとして記録

---

## [v3.1] - 2026-02-02

### 追加（Added）

- **フロントエンドサブスクリプションUI**
  - プラン・課金画面（/upgrade）実装
  - プラン比較カード表示
  - Stripe Checkoutへのリダイレクト
  - サブスクリプション状態表示
  - キャンセル・再開機能
  - サイドバーにプラン・課金リンク追加

- **プラン制限機能**
  - SubscriptionContext（サブスクリプション状態管理）
  - UpgradePromptコンポーネント（制限通知・アップグレード誘導）
  - LimitBadgeコンポーネント（制限数表示）

- **Google AdSense対応**
  - AdBannerコンポーネント（基本広告バナー）
  - FreeUserAdコンポーネント（Freeプラン専用広告表示）
  - 環境変数によるAdSense設定（クライアントID・広告スロットID）
  - 公開ページへの広告配置（ヘッダー下/ギャラリー上/フッター上）

- **管理画面へのプラン制限表示統合**
  - 作品管理: 作品数制限表示・上限時ボタン無効化
  - SNSリンク管理: リンク数制限表示・上限時ボタン無効化
  - 投稿管理: 投稿数制限表示・上限時ボタン無効化
  - カテゴリー管理: カテゴリー数制限表示・上限時ボタン無効化

### 変更（Changed）

- カテゴリー数制限チェック追加（PRO: 5, STUDIO: 無制限）
- STUDIOプランのSNSリンク制限を無制限に修正

### 注意（Notes）

- AdSense環境変数: NEXT_PUBLIC_ADSENSE_CLIENT_ID, NEXT_PUBLIC_ADSENSE_SLOT_*
- AdSenseはデプロイ・審査後に環境変数を設定することで有効化

---

## [v3.0] - 2026-02-02

### 追加（Added）

- **Stripe連携バックエンド実装**
  - Subscription エンティティ・リポジトリ作成
  - SubscriptionService 実装（Stripe SDK統合）
  - SubscriptionController 実装
  - Stripe Webhook処理実装
    - `checkout.session.completed` - 決済完了処理
    - `customer.subscription.updated` - サブスクリプション更新処理
    - `customer.subscription.deleted` - サブスクリプション削除処理
    - `invoice.payment_succeeded` - 支払い成功処理
    - `invoice.payment_failed` - 支払い失敗処理

- **サブスクリプションAPIエンドポイント**
  - `GET /api/subscriptions/status` - サブスクリプション状態取得
  - `POST /api/subscriptions/checkout` - Checkoutセッション作成
  - `POST /api/subscriptions/cancel` - サブスクリプションキャンセル
  - `POST /api/subscriptions/resume` - サブスクリプション再開
  - `POST /api/subscriptions/webhook` - Stripe Webhook受信

- **プラン別制限情報API**
  - PlanLimits レスポンスDTO
  - プラン別制限値の定義（maxArtworks, maxSocialLinks, maxPosts, maxCategories, maxStorageMb, hasAds）

### 変更（Changed）

- SecurityConfig: Webhook エンドポイントを公開エンドポイントに追加
- pom.xml: Stripe Java SDK 24.15.0 追加
- application.yml: Stripe設定セクション追加

### 注意（Notes）

- Stripe APIキー・Webhook Secretは環境変数で設定が必要
  - STRIPE_API_KEY
  - STRIPE_WEBHOOK_SECRET
  - STRIPE_PRICE_ID_STARTER / STRIPE_PRICE_ID_PRO / STRIPE_PRICE_ID_STUDIO

---

## [v2.1.5] - 2026-01-30

### 追加（Added）

- **詳細設計書にバリデーションルール一覧セクションを追加**
  - 用語定義（ユーザーID / ユーザー名 / 表示名）
  - 全フィールドの文字数制限を明記
  - プラン別制限を明記

- **テスト仕様書（xlsx形式）を追加**
  - `docs/test/PicMe_テスト仕様書_v2.1.xlsx`
  - 具体的なテスト値を記載
  - 設計書との整合性を確認済み

### 変更（Changed）

- **バリデーション制限の変更（設計書・実装両方）**
  - 表示名（displayName）: 100文字 → **32文字**
  - カテゴリー名: 100文字 → **50文字**
  - タグ名: 50文字 → **30文字**

- **プラン別投稿制限の変更**
  - FREE: 5件 → **1件**
  - STARTER: 20件 → **5件**
  - PRO: 20件（変更なし）
  - STUDIO: 無制限（変更なし）

---

## [v2.1.4] - 2026-01-30

### 追加（Added）

- **公開プロフィールページのデザイン強化**

  - **アバターのビューポート対応**
    - `min()` 関数を使用したレスポンシブサイズ
    - SP: `min(45vw, 220px)` / PC: `min(30vw, 280px)` / 大画面: `min(25vw, 320px)`
    - ホバー時のシャドウ拡大アニメーション追加
    - グラデーション背景のフォールバック表示

  - **SNSアイコンの大型カラフルデザイン**
    - プラットフォーム別背景色（Twitter=黒、Instagram=グラデーション、Facebook=青、YouTube=赤、Pixiv=水色）
    - 角丸正方形ボタン（`rounded-2xl` / `rounded-3xl`）
    - ホバー時の回転・拡大エフェクト
    - プラットフォーム名のホバー表示

### 変更（Changed）

- SNSリンクのUIをボタン形式からカラフルアイコンブロックに変更
- アバターの境界線を `border-slate-100` から `border-white` に変更

---

## [v2.1.3] - 2026-01-28

### 追加（Added）

- **デザイン拡張（v2.1 Phase 5）の実装**

  - **余白・レイアウト改善**
    - ヘッダーエリア高さを `min-h-[45vh]` に拡大
    - セクション間余白を `mt-32` → `mt-40 md:mt-48` に拡大
    - カード・グリッドの余白を `p-4` → `p-6` に拡大
    - 角丸を `rounded-xl` → `rounded-2xl` / `rounded-3xl` に拡大

  - **アイコン・アバターサイズ拡大**
    - メインアバター: `160px` → `180px (SP) / 240px (PC)`
    - SNSアイコン: `32px` → `40px (SP) / 48px (PC)`
    - スキルバードット: `h-3 w-3` → `h-4 w-4` + グロー効果
    - セクションタイトル: `text-4xl` → `text-6xl md:text-7xl`

  - **作品グリッドの改善**
    - カラム数変更: `3カラム` → `2カラム (PC) / 1カラム (SP)`
    - 作品カードホバー: `scale-105` + 強化されたシャドウ効果
    - 作品カード下にタイトル・日付表示を追加
    - MasonryGridにレスポンシブ対応（`mobileColumns` prop追加）

  - **コンポーネント更新**
    - `masonry-grid.tsx`: レスポンシブカラム対応
    - `skill-bar.tsx`: サイズ拡大、グロー効果追加
    - `section-title.tsx`: サイズ拡大、カラー調整
    - `bento-grid.tsx`: 余白・角丸・ホバー効果改善

### 変更（Changed）

- 公開プロフィールページ全体のデザインリファイン
- BentoGridItemのフォントサイズ・余白調整

---

## [v2.1.2] - 2026-01-28

### 変更（Changed）

- **デザイン設計書の更新**
  - アバターサイズ、アイコンサイズの大型化。
  - 作品表示の変更案反映。
  - `docs/画面設計書.md` を v2.1.2 に更新。
  - `docs/画面設計進捗管理.md` のデザイン拡張フェーズを "v3.0" から "v2.1" に変更（マイナーバージョンとしての実装へ変更）。

---

## [v2.1.1] - 2026-01-28

### 修正（Fixed）

- **Hydration Mismatch 警告の抑制**
  - ブラウザ拡張機能（WOT等）によって注入される属性（`wotdisconnected`等）に起因するサーバー・クライアント間のHTML不一致警告を抑制するため、`layout.tsx` の `body` タグに `suppressHydrationWarning` を追加。

---

## [v2.1] - 2026-01-28

### 修正（Fixed）

- **Next.js 15 非同期 Params 対応**
  - `generateMetadata` および Client Component での `params` Promise アンラップ処理の実装。
  - インポート文の欠落による Runtime Error (`Loader2 is not defined`) の修正。

- **Docker コンテナ間通信（Networking）の改善**
  - Next.js サーバーサイドからバックエンドへのリクエストが `localhost` で失敗する問題を修正。
  - `INTERNAL_API_URL` 環境変数を導入し、`docker-compose` ネットワーク経由で `http://backend:8080` を参照するように変更。

---

## [v2.0] - 2026-01-28

### 追加（Added）

- **お知らせ・ブログ機能**
  - Post エンティティ・API実装
  - フロントエンドUI（B05画面）
  - マークダウン表示対応（Pro以上で編集機能予定）

- **テーマ・カスタマイズ機能**
  - 複数テーマプリセット実装
  - カラーピッカーUI実装（Pro以上）
  - フォント選択機能実装（Pro以上）
  - テーマプレビュー機能
  - テーマ適用・保存ロジック

- **カテゴリー・タグ機能**
  - Category・Tag エンティティ作成
  - カテゴリー・タグ管理API実装
  - フロントエンド管理画面（B05）
  - 作品フィルタリング機能
  - 公開ページでのカテゴリー・タグフィルター表示
  - タグクラウド表示

- **テスト仕様書**
  - Phase 1-3 総合テスト仕様書作成（271テストケース）
  - テスト成績記入用フォーマット設計

- **バージョン管理**
  - Phaseからバージョン表記（v0.1-v5.0）への統一
  - セマンティックバージョニング導入

### 変更（Changed）

- 進捗管理をPhase表記からVersion表記へ統一
- 画面設計進捗管理ドキュメントの表記統一
- セマンティックバージョニング採用

### 修正（Fixed）

- カテゴリー・タグの削除時の使用中チェック

### 削除（Removed）

- _なし_

### セキュリティ（Security）

- XSS対策（カテゴリー・タグ・投稿テキストのエスケープ）
- CSRF保護確認（各POSTエンドポイント）

---

## [v1.0] - 2026-01-22

### 追加（Added）

- **認証機能**
  - ユーザー登録・ログイン機能
  - JWT トークンベース認証
  - パスワードのハッシュ化（BCrypt）
  - トークンリフレッシュ機能
  - ログアウト機能

- **プロフィール機能**
  - ユーザープロフィール表示・編集
  - 表示名・自己紹介・アイコン管理
  - プロフィール画像アップロード（URL入力）

- **作品ギャラリー機能**
  - 作品CRUD操作
  - 作品画像アップロード
  - 作品並び替え機能
  - プラン別作品数制限（FREE: 5, STARTER: 20, PRO: 50, STUDIO: 200）

- **SNSリンク機能**
  - SNSリンク追加・編集・削除
  - 複数プラットフォーム対応（Twitter/X, Instagram, Pixiv など）
  - リンク表示順序管理

- **公開ページ機能**
  - ポートフォリオサイト公開機能（/@username形式）
  - OGPメタデータ自動生成
  - 画像遅延読み込み（Lazy Loading）
  - レスポンシブデザイン対応

- **ダッシュボード**
  - ユーザーダッシュボード UI
  - 統計情報表示（作品数など）
  - クイックアクション

- **開発環境**
  - Docker Compose セットアップ
  - PostgreSQL ローカル環境
  - Spring Boot 3.x バックエンド基盤
  - Next.js 15 フロントエンド基盤
  - TailwindCSS デザインシステム

### セキュリティ（Security）

- SQLインジェクション対策
- XSS対策（テキスト入力フィルタリング）
- CSRF保護（Spring Security設定）
- JWT検証とセッション管理

---

## [v0.1] - 2026-01-20

### 追加（Added）

- **プロジェクト初期化**
  - GitHub リポジトリ初期化
  - .gitignore ファイル設定
  - README.md 作成

- **フロントエンド環境**
  - Next.js 15 プロジェクト作成
  - TypeScript 設定
  - TailwindCSS 統合
  - アプリケーションフォルダ構成（app, components, lib）

- **バックエンド環境**
  - Spring Boot 3.x プロジェクト初期化
  - Maven ビルド設定
  - application.yml 基本設定
  - パッケージ構成（controller, service, repository）

- **データベース**
  - PostgreSQL 15 Docker イメージ設定
  - Docker Compose オーケストレーション
  - ローカル開発環境構築

- **ドキュメント**
  - 要件定義書作成
  - 基本設計書作成
  - 詳細設計書作成
  - 画面設計書作成
  - 進捗管理ドキュメント作成

---

## 変更ログ記入ガイドライン

新しいバージョンをリリースする際は、以下のセクションを追加してください：

```markdown
## [vX.Y.Z] - YYYY-MM-DD

### 追加（Added）
- 新機能の説明

### 変更（Changed）
- 既存機能の変更内容

### 修正（Fixed）
- バグ修正の説明

### 削除（Removed）
- 削除された機能

### セキュリティ（Security）
- セキュリティ関連の改善
```

### セクション説明

- **Added**: 新しい機能追加
- **Changed**: 既存機能の変更（後方互換性あり）
- **Deprecated**: 廃止予定機能
- **Removed**: 削除された機能
- **Fixed**: バグ修正
- **Security**: セキュリティ脆弱性修正

---

## リリーススケジュール（予定）

| バージョン | フェーズ | 目標期限 | ステータス |
|----------|---------|--------|----------|
| v0.1 | 環境構築 | 2026-01-20 | ✅ 完了 |
| v1.0 | MVP機能 | 2026-01-22 | ✅ 完了 |
| v2.0 | 追加機能 | 2026-01-28 | ✅ 完了 |
| v3.0 | 有料機能（バックエンド） | 2026-02-02 | ✅ 完了 |
| v3.1 | 有料機能（フロントエンド） | 2026-02-02 | ✅ 完了 |
| v4.0 | 管理者機能（計画） | 2026-02-03 | ✅ 完了 |
| v4.0.1 | 管理者機能（バグ修正） | 2026-02-03 | ✅ 完了 |
| v4.1 | 管理者機能（実装） | 2026-02-03 | ✅ 完了 |
| v4.2 | Cloudinary画像UP + 管理者作成 | 2026-02-07 | ✅ 完了 |
| v4.3 | SendGridメール + メール認証 + パスワードリセット | 2026-02-07 | ✅ 完了 |
| v4.4 | Pro機能（問い合わせ・解析・カスタムCSS） | 2026-02-07 | ✅ 完了 |
| v4.5 | UX改善（D&D並び替え + Markdownエディタ） | 2026-02-07 | ✅ 完了 |
| v4.6 | ドキュメント整備 + バグ修正 | 2026-02-07 | ✅ 完了 |
| v5.0 | テスト実装 | 2026-02-07 | ✅ 完了 |
| v5.1 | バグ修正 + セキュリティ対策 | 2026-02-07 | ✅ 完了 |
| v5.2 | 本番デプロイ | 2026-02-08 | 🔧 進行中 |

---

## 更新情報

- **作成日**: 2026-01-28
- **最終更新**: 2026-02-08
- **管理者**: PicMe Development Team

---

*このファイルはセマンティックバージョニングの原則に従って更新されます。*
